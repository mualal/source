\begin{document}

\subsection{Какие сетки используем в гидродинамическом моделировании? Приведите примеры различных сеток и опишите их специфику.}

\includegraphics[width=\textwidth, page=23]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Как можно пространство разбить на ячейки?

Самое простое: нарезать параллелепипеды, тогда получится блочно-центрированная сетка ячеек.

Но пласт у нас неровный. Осадконакопление происходит неравномерно, либо происходят какие-то тектонические процессы после осадконакопления и формирования пласта.
Соответственно пласт какой-то изогнутый и с помощью блочно-центрированных ячеек эту изогнутость воспроизвести сложно (придётся сильно измельчать сетку в областях сильных изогнутостей, и это будет сильно замедлять расчёт), поэтому нужно придумать более гибкие ячейки, чтобы описать изгибы пласта под землёй.

Придумали сетки ячеек, которые называются геометрией угловой точки.
Для их построения задаются направляющие линии, и на этих направляющих линиях задаются глубины точек, которые являются вершинами для ячейки и таким образом плоскости граней ячейки могут быть повёрнуты куда угодно, т.е. ячейки становятся более гибкими.
На сегодняшний момент 3D геометрия угловой точки является самым популярным способом построения сетки для геологической/гидродинамической модели, чтобы описать строение пласта.
\\

\textbf{Сетка Вороного}

\includegraphics[width=\textwidth, page=24]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Также есть так называемая сетка Вороного (или перпендикулярный бисектор).
Это локально ортогональная сетка, в которой грани соседних ячеек равноудалены от центров этих ячеек.
То есть если мы расставим точки центров ячеек и нарисуем грани этих ячеек так, чтобы они были равноудалены от этих точек центров, то получатся как раз шестиугольники (подобные пчелиным сотам).
Такая сетка позволяет более точно описать приток к скважине.
\\

\textbf{Типы сеток ГДМ. LGR}

\includegraphics[width=\textwidth, page=25]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Сетку можно измельчать или укрупнять. Понятно, что если будем сетку измельчать, то их количество будет расти, для каждой из этих ячеек нам придётся решать уравнения фильтрации (как из одной ячейки в другую перетекает флюид), и это будет замедлять расчёт. Но с другой стороны можем более точно в какой-то области замоделировать течение флюидов.

Здесь (как всегда) приходится искать компромисс между точностью и скоростью.
Если нужно какие-то эффекты точно воспроизвести в заданной области, то можем сетку локально измельчить.
Но также могут быть ячейки, потоки в которых нам особо неинтересны (например, в тех ячейках, где течёт в основном вода) -- такие ячейки укрупняем (тем самым уменьшаем количество ячеек и сокращаем время расчёта).

Можем строить радиальную сетку, но на практике, честно говоря, ни разу не видел, чтобы кто-то пользовался.
На радиальной сетке проводят в основном теоретические расчёты, но на практике она не используется.
\\

\textbf{Порядок нумерации ячеек сетки}

\includegraphics[width=\textwidth, page=26]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Как происходит нумерация ячеек сетки?

Сначала изменяется координата по $x$, потом по $y$, потом по $z$.
Начинаем с левого верхнего угла (ячейка с координатами $\left(1,1,1\right)$), следующие ячейки $\left(2,1,1\right)$, $\left(3,1,1\right)$, $\left(4,1,1\right)$ и так далее. Здесь 8 ячеек по $x$.
Далее переходим ко второму ряду по $y$, начиная с ячейки $\left(1,2,1\right)$ переходим к $\left(2,2,1\right)$ и так далее.
После всех рядов по $y$ переходим на следующий слой по $z$.

Я это рассказываю, чтобы было понимание, в каком порядке номера ячеек меняются, чтобы можно было при визуализации найти какую-то ячейку, которая вам интересна.
Например, если вы знаете, какую ячейку вскрывает скважина.
\\

\textbf{Численные эффекты дискретизации}

\includegraphics[width=\textwidth, page=37]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Численный эффект, возникающий при дискретизации,  -- это эффект ориентации сетки.
Он заключается в том, что время прихода флюида из одной точки в другую зависит от того, сколько ему нужно пройти ячеек.

Видим, что в случае, когда добывающие скважины расположены по диагонали ячеек сетки, вода к ним приходит позже.
Это такой чисто численный эффект, который нужно как-то исключить. 

\includegraphics[width=\textwidth, page=38]{Kurs_OsnovyGDM_Kai_774_gorodovSV_v6_0.pdf}

Для уменьшения/исключения эффекта ориентации сетки можно измельчить сетку, использовать альтернативные численные схемы (которые учитывают взаимодействие ячеек по диагонали; естественно эти вычислительные схемы усложняют расчёт и требуют дополнительных вычислительных ресурсов), можно использовать сетку Вороного (позволяет более точно смоделировать приток к скважине, т.е. уменьшить эффект ориентации сетки) или линии тока (но линии тока являются неким упрощением, когда мы решаем для насыщенности одномерную задачу; про линии тока поговорим ещё дальше по курсу).

Для ячеек Вороного (PEBI) тоже есть сложности с решением систем уравнений, ведь у PEBI самих граней, через которые течёт поток, больше (у прямоугольной ячейки 6 граней, у ячейки Вороного 8 граней), соответственно, и сами матрицы систем уравнений становятся сложнее для решения.
Углубляться не будем.

Вообще рекомендация такая: желательно ориентировать сетку ячеек по направлению основных потоков, которые в пласте происходят.
Эти потоки могут быть связаны как с сеткой скважин, так и с региональными стрессами (какими-либо разломами, трещиноватостями). Всё равно есть преимущественные направления фильтрации, и сетку желательно ориентировать так, чтобы она была в направлении этих потоков (в направлении фильтрации).

Сетку Вороного не нужно ориентировать; для сетки Вороного пропадает численный эффект ориентации сетки.
Но для сетки Вороного есть другая проблема: поток не всегда направлен перпендикулярно грани ячейки в случаях локального измельчения сетки.


\end{document}