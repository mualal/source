\documentclass[main.tex]{subfiles}

\begin{document}

% \textcolor{red}{Вводная лекция}

\section{Лекция 11.05.2021 (Байкин А.Н.)}

\subsection{Моделирование течения жидкости в скважине}

Мы с вами движемся дальше.
Сегодня у нас будет тема про моделирование скважин.
Т.е. до этого мы рассматривали преимущественно именно процессы в самой трещине, процессы в окружающем пласте (такие как утечки или деформация породы), а закачка всегда предполагалась на забое скважины (расход задавался на входе в саму трещину).
Но вообще говоря у нас с вами есть скважины и то давление на входе в трещину, которое мы получаем в расчётах, не совпадает с давлением, которое мы получаем при измерении какими-то приборами (как на поверхности, так и когда мы опускаем датчик давления вниз к забою).
\\

\subsubsection{Зачем моделировать скважину?}

\includegraphics[width=\textwidth, page=65]{HF_slides_2022.pdf}

Зачем нам необходимо моделировать скважину?

Во-первых, чтобы знать, какое давление на забое скважины и как оно соотносится с давлением на устье скважины.
Почему это важно?
С одной стороны, можно было бы сказать: давайте поставим датчик давления на забое и всё будет классно, но этот датчик давления будет стоять не на самой трещине (т.е. между датчиком и трещиной будет либо участок трубы, либо как минимум участок с перфораций вдоль которых возникает падение давления из-за трения; в итоге, измеряемое давление BHP будет немного выше, чем давление на входе в трещину).
Датчик забойного давления BHP практически никогда не ставят, потому что это дорого; обычно мы знаем только давление на устье WHP.

Чтобы осуществить пересчёт BHP через известное WHP нам необходимо учесть падение давления за счёт трения жидкости при движении по трубе и гидростатическое давление.
Т.е. получаем, что за счёт трения давление на забое снижается (относительно WHP), а за счёт гидростатики давление на забое увеличивается (относительно WHP).

Кроме того, скважину интересно моделировать, чтобы объяснить наблюдаемый hammer effect: при резком закрытии скважины наблюдаются колебательные движения жидкости между скважиной и трещиной, которые имеют форму затухающих колебаний.
И по этим затухающим колебаниям пытаются проводить диагностику. Как минимум говорят, что если есть hammer effect, то связь между скважиной и трещиной достаточно хорошая (т.е. перфорацию сделали достаточно качественно).
Дальше по hammer эффекту пытаются оценить размеры трещины (ширину, длину).

Ещё дальше пытаются понять, какой порт заработал (если есть несколько портов) -- правда это уже немного другая технология, которая называется tube waves от компании Schlumberger.
\\

\includegraphics[width=\textwidth, page=66]{HF_slides_2022.pdf}

Для чего ещё моделировать скважину?

Если мы запустили пульсы проппанта (с определённой концентрацией) наверху (на устье), то никто не говорит, что они в таком же виде дойдут до забоя.
Вообще говоря, они могут размазаться.
Сегодня мы размазывание не будем рассматривать, потому что для этого нужна двухскоростная модель, а сегодня мы рассмотрим только односкоростную модель.
Но вообще говоря из-за того, что у нас есть профиль скорости, частички проппанта будут собираться (проваливаться) к центру.

Размазывание концентрации проппанта важно моделировать, чтобы понимать, какое значение концентрации будет на входе в трещину.


\underline{Замечание аудитории.}
Слышали, что при движении по круглой трубе частички проппанта будут собираться в кольцо на расстоянии 0.6 радиуса от центра.
Говорят, что это связано с тем, что сами частички проппанта могут крутиться вокруг своей оси.


Сегодня рассмотрим модель попроще, чтобы вы поняли общую схему, а дальше уже можно придумывать более сложные модели (главное понять, какой эффект хочется описать).
\\

\subsubsection{Предположения модели}

\includegraphics[width=\textwidth, page=67]{HF_slides_2022.pdf}

Теперь давайте приступим к самой модели.

Основные предположения модели:

1) наклонная скважина переменного радиуса $R$ (на рисунке я специально нарисовал 2 цилиндра, т.к. скважина вообще говоря может иметь переменное сечение, но в реальности оно обычно кусочно постоянное);

2) односкоростная модель $\vec{u}_p=\vec{u}_f=\vec{u}_m$ (жидкость и проппант движутся с одинаковой скоростью и эта скорость равна усреднённой скорости, формула для которой была в прошлый раз) -- это оправдано, когда жидкость достаточно вязкая и частички проппанта как-бы заморожены в жидкость;

3) жидкость неньютоновская (т.е. жидкость со степенной реологией);

4) течение не расслаивается (не может быть такого , что проппант где-то внизу пошёл и течение расслоилось);

5) ламинарный, переходный, турбулентный режимы;

6) сжимаемостью пренебрегаем.
\\

\subsubsection{Определяющие уравнения}

\includegraphics[width=\textwidth, page=68]{HF_slides_2022.pdf}

Что нам нужно, чтобы описать течение рассматриваемой жидкости?

1) Закон сохранения объёма проппанта:
\beq\label{ZSM_proppant}
\frac{\partial\left(cS(x)\right)}{\partial t}+\frac{\partial\left(cS(x)u_p\right)}{\partial x}=0,\,\,\,\,\,c_p\equiv c
\eeq

2) Закон сохранения объёма жидкости:
\beq\label{ZSM_fluid}
\frac{\partial\left((1-c)S(x)\right)}{\partial t}+\frac{\partial\left((1-c)S(x)u_f\right)}{\partial x}=0,\,\,\,\,\,c_f\equiv 1-c
\eeq

Уравнения \eqref{ZSM_proppant} и \eqref{ZSM_fluid} уже усреднённые по сечению скважины, но они выводятся точно также, как и для течения проппанта в трещине (только сейчас вместо раскрытия трещины $w(x)$ используем площадь сечения $S(x)$ и сейчас нет утечек).

Далее используя предположение односкоростной модели $u_p=u_f=u_m$, где $u_m$ -- среднеобъёмная усреднённая скорость смеси по сечению $S(x)$, складываем уравнения \eqref{ZSM_proppant} и \eqref{ZSM_fluid}:
\beq\label{Q_const_t}
\frac{\partial\left(S(x)u_m\right)}{\partial x}=\frac{\partial\left(Q(t,x)\right)}{\partial x}=0,
\eeq
где $Q(t,x)=Su_m=const(t)=Q_{inlet}(t),\,\,\,\,S=\pi R^2$.

Полученное уравнение говорит нам о том, что расход через любое поперечное сечение скважины одинаков и зависит от расхода, закачиваемого в скважину сверху.
Если изменяется сечение скважины, то соответственно изменяется скорость течения так, чтобы расход оставался прежним.

3) Граничное условие (на концентрацию проппанта) на устье скважины:
\beq\label{proppant_concentration_gu}
c|_{x=0}=c_{inlet}(t)
\eeq

Если проводить аналогию с течением проппанта в трещине, то уравнение \eqref{Q_const_t} аналогично эллиптическому уравнению, в котором необходимо было искать давление.

В итоге: мы знаем расход $Q_{inlet}(t)$; знаем площадь $S(x)$; можем найти скорость $u_m(x,t)$; как только знаем скорость, мы можем подставить её в уравнение \eqref{ZSM_proppant}, решить это уравнение и с учётом граничного условия \eqref{proppant_concentration_gu} найти концентрацию проппанта.
\\

При решении данной задачи можно использовать тот же алгоритм, что и для переноса проппанта в трещине, т.е. взять одномерную разностную схему (например, Лакса-Вендроффа с лимитерами), но я хотел бы ещё показать другой численный алгоритм.
В данном случае, когда рассматриваем односкоростную модель, этот алгоритм проще, намного быстрее и точнее.
\\

\subsubsection{Численный алгоритм}

\includegraphics[width=\textwidth, page=69]{HF_slides_2022.pdf}

Можно показать, что в случае односкоростной модели уравнение \eqref{ZSM_proppant} для переноса проппанта можно переписать в более простом виде:
\beq\label{ProppantTransfer}
\frac{\partial c}{\partial t}+u_m\frac{\partial c}{\partial x}=0
\eeq
(уравнение \eqref{ZSM_proppant} -- это закон сохранения в дивергентной форме; а уравнение \eqref{ProppantTransfer} -- это классическое уравнение переноса, которое всем известно с урматов).

Физический смысл уравнения \eqref{ProppantTransfer}: концентрация $c$ неизменно переносится векторным полем $\vec{u}$ (в данном случае со скоростью $u_m$ вдоль скважины).

Разобьём суммарное время закачки на $k-1$ временных интервалов:
\beq
\Delta t_k=t_k-t_{k-1},\,\,\,\,\,t_0=0
\eeq

Обозначение: $F_k$ -- это значение величины $F$ в момент времени $t_k$.

В лагранжевых координатах $(t,X)$ на интервале $[t_k, t_{k+1}]$ имеем решение вида:
\beq\label{LagrangePosition}
c(t,X(t))=c(t,X|_{t=t_k}),\,\,\,\,\,X(t)=X|_{t=t_k}+\int\limits_{t_k}^{t}u_m(X(s))ds
\eeq

Грубо говоря, мы в начале трубы выпускаем некоторую лагранжеву частицу со скоростью $u_m$, и формула \eqref{LagrangePosition} говорит нам, что эта частица через время $t$ дойдёт до положения с координатой $X$.

\includegraphics[width=\textwidth, page=70]{HF_slides_2022.pdf}

Соответственно мы можем рассматривать весь этот процесс в виде набора фронтов концентрации.
За каждый новый шаг по времени мы выпускаем новый фронт, далее он движется по трубе и мы фиксируем кусочно постоянный уровень концентрации проппанта на каком-то участке скважины.

Чтобы перейти в эйлерову сетку в точке $x$, мы просто смотрим между какими фронтами эта точка $x$ лежит и говорим, что концентрация равна этому значению.
\\

\includegraphics[width=\textwidth, page=71]{HF_slides_2022.pdf}

Нам нужна не только концентрация, а прежде всего нам нужно знать давление.
Если на забое будет слишком большое давление, то жидкость может просто порвать трубу.
Как будем считать давление?
Для этого берём уравнение Навье-Стокса.
Выводим аналогично выводу транспорта проппанта для трещины.
Но здесь в роли малого параметра будет
$$\varepsilon=\frac{2R}{L},$$
где $2R$ -- диаметр скважины; $L$ -- длина скважины.

Вдоль оси $Ox$:
\beq
0=-\frac{dp(x)}{dx}+\frac{1}{r}\frac{d}{dr}\left(r\tau_{rx}\right)+\rho g\sin\theta
\eeq

\beq
\tau_{ij}=2\mu_sD_{ij},\,\,\,\,\,D=\frac{1}{2}\left(\nabla u + (\nabla u)^T\right),\,\,\,\,\,\tau_{rx}=\mu_s\frac{\partial u_x}{\partial r}
\eeq

Есть зависимость вязкости смеси от концентрации проппанта.
Формула Нолти:
\beq
\mu_s(c)=\mu_f\left(1-\frac{c}{c_{max}}\right)^{-2.5n_{clean}},
\eeq
где $c_{max}=0.65$ -- максимальная концентрация упаковки, $\mu_f$ -- вязкость чистой жидкости (гель без проппанта), $n_{clean}$ -- индекс течения чистой жидкости (без проппанта).

\includegraphics[width=\textwidth, page=72]{HF_slides_2022.pdf}

По сути сейчас докажем формулу Пуазейля с учётом силы тяжести:
\beq
0=-\frac{dp(x)}{dx}+\frac{1}{r}\frac{d}{dr}\left(r\mu_s\frac{\partial u_x}{\partial r}\right)+\rho g \sin{\theta}
\eeq
\beq
\frac{d}{dr}\left(r\mu_s\frac{\partial u_x}{\partial r}\right)=\left(\frac{dp(x)}{dx}-\rho g\sin{\theta}\right)r
\eeq

С учётом $\tau_{rx}|_{r=0}=0$ (условие регулярности):
\beq
\mu_s\frac{\partial u_x}{\partial r}=\left(\frac{dp}{dx}-\rho g\sin{\theta}\right)\frac{r}{2}
\eeq

Интегрируем:
\beq
u_x(r)=\frac{1}{4\mu_s}\left(\frac{dp}{dx}-\rho g\sin{\theta}\right)r^2+C
\eeq

Используем граничное условие $u_x|_{r=R}=0$:
\beq
u_x(r)=\underbrace{-\frac{R^2}{4\mu_s}\left(\frac{dp}{dx}-\rho g\sin{\theta}\right)}_{u_{max}}\left(1-\frac{r^2}{R^2}\right)=u_{max}\left(1-\frac{r^2}{R^2}\right)
\eeq

\subsubsection{Вычисление средней скорости}

\includegraphics[width=\textwidth, page=73]{HF_slides_2022.pdf}

Нашли максимальную скорость $u_{max}$, а уравнение переноса записано в терминах средней скорости, поэтому необходимо найти соотношение между средней скоростью и максимальной скоростью.

Возьмём и усредним найденный профиль скорости по сечению:
\begin{multline}
u_m=\frac{1}{|S|}\int\limits_S{u_xdS}=\frac{1}{\pi R^2}\int\limits_{0}^{2\pi}\int\limits_{0}^{R}u_{max}r\left(1-\frac{r^2}{R^2}\right)drd\varphi=\\=u_{max}\frac{2\pi}{\pi}\int\limits_0^1\frac{r}{R}\left(1-\frac{r^2}{R^2}\right)d\left(\frac{r}{R}\right)=\frac{u_{max}}{2}
\end{multline}

Таким образом, получаем среднюю скорость ламинарного течения.
В целом отсюда можно найти давление для ламинарного течения!

\subsubsection{Средняя скорость для степенной жидкости}

\includegraphics[width=\textwidth, page=74]{HF_slides_2022.pdf}

В тех же самых предположениях можем вывести профиль скорости для степенной жидкости:
\beq
\tau_{ij}=K_s\dot{\gamma}^{n-1}D_{ij},\,\,\,\,\,\dot{\gamma}=\sqrt{\frac{1}{2}\sum\limits_{i,j=1}^{3}D_{ij}^2}
\eeq
Профиль скорости:
\beq
u_x=u_{max}\left(1-\left(\frac{r}{R}\right)^{(n+1)/n}\right)
\eeq
\ \\

\subsubsection{Коэффициент трения Фаннинга}

\includegraphics[width=\textwidth, page=75]{HF_slides_2022.pdf}

Сейчас выведем формулу для давления немного по-другому.
Опять стартуем с уравнения Навье-Стокса и сразу усредняем:
\beq
0=-\frac{dp(x)}{dx}+\frac{1}{r}\frac{d}{dr}\left(r\tau_{rx}\right)+\rho g \sin{\theta}\,\,\bigg|\,\,\,\,\,\frac{1}{\pi R^2}\int\limits_S(\cdot)dS
\eeq

Получаем:
\beq\label{PressureGeneral}
\frac{d\overline{p}}{dx}=-\frac{2\tau_w}{R}+\overline{\rho}g\sin{\theta},
\eeq
где $\tau_w=-\tau_{rx}|_{r=R}$ -- напряжение сдвига (трения) на стенке трубы.
Его можно измерить и в случае турбулентного течения (например, для известного перепада давления найти $\tau_w$ из \eqref{PressureGeneral}), поэтому этот вывод формулы для давления более общий (в предыдущем выводе не понятно, что такое профиль скорости в случае турбулентного течения).

Видим, что для определения давления профиль скорости нам и не нужен.

Обычно экспериментаторы работают с безразмерными величинами для того, чтобы можно было масштабировать результаты (измерить на одной трубе, а распространить результаты на трубы произвольного диаметра), поэтому вводят коэффициент трения Фаннинга:
\beq
f_s=\frac{\tau_w}{\rho u_m^2/2}
\eeq

Тогда уравнение \eqref{PressureGeneral} примет вид:
\beq
\frac{dp}{dx}=-\frac{\rho u_m^2}{R}f_s+\rho g\sin{\theta}
\eeq

Какой физический смысл у полученного уравнения?
Это баланс сил: есть сила давления, кроме того проталкивать жидкость нам помогает сила тяжести, а препятствует трение жидкости о стенки трубы.
\\

\includegraphics[width=\textwidth, page=76]{HF_slides_2022.pdf}

Давайте посчитаем коэффициент Фаннинга для ламинарного течения.

Профиль скорости:
\beq
u_x=2u_m\left(1-\left(\frac{r}{R}\right)^2\right)
\eeq

Подставляем профиль скорости в выражение для $\tau_w$:
\beq
\tau_w=-\mu_s\frac{\partial u_x}{\partial r}\bigg|_{r=R}=\frac{4\mu_s u_m}{R}
\eeq

Подставляем $\tau_w$ в выражение для коэффициента Фаннинга:
\beq
f_s=\frac{\tau_w}{\rho u_m^2/2}=\frac{4\mu_s u_m}{R\rho u_m^2/2}=\frac{8\cdot 2}{\rho u_m(2R)/\mu_s}=\frac{16}{Re},
\eeq
где
$$Re=\frac{\rho u_m(2R)}{\mu_s}$$

Для степенной жидкости можно показать, что
\beq
f_s=\frac{16}{Re'},
\eeq
где
$$Re'=\dfrac{\rho u_m^{2-n}(2R)^n}{K_s\left(\dfrac{3n+1}{4n}\right)^n8^{n-1}}-\text{обобщённое число Рейнольдса}$$

\includegraphics[width=\textwidth, page=77]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=78]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=79]{HF_slides_2022.pdf}

Для турбулентного течения явной формулы для коэффициента Фаннинга нет, но есть экспериментальные корреляции.

\subsubsection{Расчёт давления}

Теперь давайте перейдём к самому расчёту давления.
\beq
\frac{d\overline{p}}{dx}=-\frac{2\tau_w}{R}+\overline{\rho}g\sin{\theta}
\eeq

\beq
p_{bh}(t,x)=p_{wh}(t)+\Delta p_h(t,x)-\Delta p_{fric}(t,x)
\eeq

Гидростатика:
\beq
\Delta p_h(t,x)=\int\limits_{0}^{x}\rho_s(c(t,s))g\,\sin{\theta(s)}ds
\eeq

\beq
\rho_s(c)=\rho_p c+\rho_f\left(1-c\right)
\eeq

Трение:
\beq
\Delta p_{fric}(t,x)=\int\limits_0^x\frac{2\tau_w(t,s)}{R(s)}ds - \text{давление трения}
\eeq

\includegraphics[width=\textwidth, page=80]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=81]{HF_slides_2022.pdf}

Переходим к следующей теме.

\subsection{Разделение потоков между трещинами}

В предыдущем разделе рассмотрели скважину от устья до забоя.
Но у нас между трещиной и забоем могут быть участки скважины (во-первых, датчик забойного давления обычно выше трещины; во-вторых, у нас есть трение вдоль перфораций).
Это ещё усугубляется задачей многостадийного ГРП, когда у нас есть несколько портов.

\includegraphics[width=\textwidth, page=82]{HF_slides_2022.pdf}

Я вам рассказывал про технологию plug and purf, когда опускают перфорационный пистолет, который сразу может сделать несколько отверстий (портов).
В итоге при закачке растим несколько трещин и весь расход, который качаем в скважину, перераспределяется между трещинами.
В зависимости от чего?
Во-первых, в зависимости от трения по трубе и гидростатики.
Во-вторых (что более существенно), от давления на перфорациях.
Например, одна перфорация сделана хорошо и через неё будет хорошая проводимость.
Другая перфорация сделана плохо и через неё будет плохая проводимость.
Кроме того, есть эффект влияния соседних трещин друг на друга.
\\

Если есть 3 трещины, то боковые трещины пойдут криво, но мы это не учитываем (пока рассматриваем плоские трещины).

Если успеем добраться, то потом расскажу, что делать с кривыми трещинами.

Но даже если у нас 3 плоские трещины, то боковые трещины за счёт упругого воздействия через породу зажимают центральную трещину.
Соответственно в боковые трещины будет втекать больше жидкости и расход на них будет выше, чем в центральной части.

\includegraphics[width=\textwidth, page=83]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=84]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=85]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=86]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=87]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=88]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=89]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=90]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=91]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=92]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=93]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=94]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=95]{HF_slides_2022.pdf}

\includegraphics[width=\textwidth, page=96]{HF_slides_2022.pdf}


\subsection{Математическая модель гидроудара в вертикальной скважине}





\end{document}